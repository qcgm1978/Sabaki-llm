# 国内构建加速指南

## 1. 已配置的镜像源

已在项目根目录创建`.npmrc`文件，配置了以下国内镜像源：

```
# Electron国内镜像配置
electron_mirror=https://npmmirror.com/mirrors/electron/
electron_builder_binaries_mirror=https://npmmirror.com/mirrors/electron-builder-binaries/
```

## 2. 其他加速方法

### 2.1 配置 npm 全局镜像

```bash
# 配置淘宝镜像
npm config set registry https://registry.npmmirror.com/

# 配置Electron镜像（全局）
npm config set electron_mirror https://npmmirror.com/mirrors/electron/
```

### 2.2 使用 yarn 并配置镜像

```bash
# 安装yarn（如果尚未安装）
npm install -g yarn

# 配置yarn镜像
yarn config set registry https://registry.npmmirror.com/
yarn config set electron_mirror https://npmmirror.com/mirrors/electron/
```

### 2.3 使用 cnpm

项目已经包含 cnpm 相关脚本，cnpm 默认使用淘宝镜像：

```bash
# 使用cnpm安装依赖
cnpm install

# 使用cnpm构建
cnpm run dist:macos
```

## 3. 构建缓存

Electron 下载后会自动缓存，后续构建不会重复下载。缓存位置：

- macOS: `~/Library/Caches/electron/`
- Windows: `%LOCALAPPDATA%/electron/Cache/`
- Linux: `~/.cache/electron/`

## 4. 常见问题

### 4.1 构建卡在下载阶段

如果构建长时间卡在下载阶段，可以尝试：

1. 取消当前构建（Ctrl+C）
2. 手动下载 Electron 二进制文件到缓存目录
3. 重新运行构建命令

### 4.2 清理缓存后重新下载

```bash
# macOS清理Electron缓存
rm -rf ~/Library/Caches/electron/

# 重新构建
cnpm run dist:macos
```

## 5. 环境变量方式

也可以通过环境变量临时指定镜像源：

```bash
# 单次构建使用环境变量
electron_mirror=https://npmmirror.com/mirrors/electron/ cnpm run dist:macos
```
